<!doctype html>
<html>
  <head>
    <title>Untitled</title>
    <link rel="stylesheet" href="style.css">
    <script language="JavaScript" src="closure/goog/base.js"></script>
    <script language="JavaScript">
      goog.require('goog.ui.Component');
      goog.require('goog.ui.Toolbar');
      goog.require('goog.ui.ToolbarRenderer');
      goog.require('goog.ui.ToolbarButton');
      goog.require('goog.ui.ToolbarColorMenuButton');
    </script>
    <script language="JavaScript" src="drawingarea.js"></script>
    <script language="JavaScript" src="notebook.js"></script>
    <script language="JavaScript" src="notebookeditor.js"></script>
  </head>
  <body>

    <div id="toolbar">
      <div id="newNotebook" title="New Notebook" class="goog-toolbar-button">
        <div class="wunjo-new-notebook">New</div>
      </div>
      <div id="closeNotebook" title="Close Notebook" class="goog-toolbar-button">
        <div class="wunjo-close-notebook">Close</div>
      </div>
      <div id="addPage" title="Add Page" class="goog-toolbar-button">
        <div class="wunjo-add-page">Add Page</div>
      </div>
      <div id="penColor" title="Pen Color" class="goog-toolbar-color-menu-button">
        Color
      </div>
    </div>
    <div id="editor"></div>

    <script>(function() {
      var nbe = new wunjo.NotebookEditor();
      nbe.decorate(goog.dom.$('editor'));

      var tb = new goog.ui.Toolbar();
      tb.decorate(goog.dom.$('toolbar'));

      // Hookup new button
      goog.events.listen(tb.getChild('newNotebook'), goog.ui.Component.EventType.ACTION, function(e) {
        nbe.setNotebook(new wunjo.Notebook('Untitled'));
      });

      // Hookup close button
      var close = tb.getChild('closeNotebook');
      close.setEnabled(false);
      goog.events.listen(close, goog.ui.Component.EventType.ACTION, function(e) {
        nbe.setNotebook(null);
      });

      // Hookup add page button
      var addPage = tb.getChild('addPage');
      addPage.setEnabled(false);
      goog.events.listen(addPage, goog.ui.Component.EventType.ACTION, function(e) {
        var nb = nbe.getNotebook();
        if (! nb) return;
        nb.addPage(new wunjo.Notebook.Page(null, 1, 1, {autosize: true}));
      });

      // Hookup penColor button
      var pc = tb.getChild('penColor');
      pc.setSelectedColor(nbe.getPen().color);
      goog.events.listen(pc, goog.ui.Component.EventType.ACTION, function(e) {
        nbe.setPen(
          e.target.getSelectedColor(),
          nbe.getPen().size
        );
      });

      goog.events.listen(nbe, 'notebookchanged', function(e) {
        var has = e.notebook ? true : false;
        close.setEnabled(has);
        addPage.setEnabled(has);
      });
    })()</script>

  </body>
</html>
<!-- vim:set ts=2 sw=2 expandtab: -->
